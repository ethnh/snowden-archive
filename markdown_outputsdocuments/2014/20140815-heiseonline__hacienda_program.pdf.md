# What is HACIENDA? 

- Data reconnaissance tool developed by the CITD team in JTRIG
- Port Seans entire countries
- Uses nmap as port scanning tool
- Uses GEOFUSION for IP Geolocation
- Randomly scans every IP identified for that country
# Countries 

- Completed full scans of 27 countries including
![img-0.jpeg](img-0.jpeg)
# Tasking \& Access 

- To task HACIENDA with a Country or Subnet
![img-1.jpeg](img-1.jpeg)
- Access to the Data
![img-2.jpeg](img-2.jpeg)
- At CSES, contact
- At NSA, contact
- At DSD, contact
# Ports 

- Pulls back hostname, banners, application names and port status
- Gathers additional information for...
-21 (ftp): directory listing
-80 (http): content of main page
-443 (https): content of main page
-111 (rpc): results of rpcinfo
![img-3.jpeg](img-3.jpeg)
![img-4.jpeg](img-4.jpeg)
# The Results 

- All stored in JTRIG's internal database
- Available in CLOBAL SURGE
- NAC's Network Knowledge Base Prototype
- Transferred by MAILORDER to
- CSEC
- DSD
- NSA NTOC
# How is it used? 

- CNE
- ORB Detection
- Vulnerability Assessments
- SD
- Network Analysis
- Target Discovery
![img-5.jpeg](img-5.jpeg)
# The Hacking Process 

(R)econnaissance
(I)nfection
(C)ommand And Control
(E)xfiltration
![img-6.jpeg](img-6.jpeg)
![img-7.jpeg](img-7.jpeg)
# REI//COMINI//REL. IO USA, AUS, CAN, CBR, NZL 

## Infection

## Email with Attachment or Link

![img-8.jpeg](img-8.jpeg)

Use Login Credentials
![img-9.jpeg](img-9.jpeg)

## Bad Web Site

## $\square$

## Intection Command and Control Exhitration

RET/COMINI//REL. IO USA, AUS, CAN, CBR, NZL
![img-10.jpeg](img-10.jpeg)
![img-11.jpeg](img-11.jpeg)
![img-12.jpeg](img-12.jpeg)
![img-13.jpeg](img-13.jpeg)
![img-14.jpeg](img-14.jpeg)
# Presentation Outline 

LANDMARK - automated tradecraft to further expand CNE covert infrastructure
![img-15.jpeg](img-15.jpeg)
# LANDMARK 

- CSEC's Operational Relay Box (ORB) covert infrastructure used to provide an additional level of non-attribution; subsequently used for exploits and exfiltration
- 2-3 times/year, 1 day focused effort to acquire as many new ORBs as possible in as many non 5-Eyes countries as possible
![img-16.jpeg](img-16.jpeg)
# LANDMARK - the recent past.... 

February 2010
Operation encompassing the whole of LONGRUN solely using OLYMPIA (CSEC's network knowledge engine with automated tradecraft)

- 8 teams of 3 network exploitation analysts busy for 5-8 hours
- A list of 3000+ potential ORBs
![img-17.jpeg](img-17.jpeg)

- BUT, network analysis still manual! Canad√°
# LANDMARK today... 

- Network analysis tradecraft to determine vulnerable devices has been encoded within OLYMPIA
![img-18.jpeg](img-18.jpeg)
# $\Delta$ 

## 1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.
# UK TOP SECRET STRAP 1 

## Use Case 1:

![img-19.jpeg](img-19.jpeg)
# Finding Orbs 

![img-20.jpeg](img-20.jpeg)
# UK TOP SECRET STRAP 1 

## Benefits

- Automated Vulnerability Assessment
- Using Vulnerability Profiles for Remote and Content Delivery vectors
- Automated Target Development and Monitoring
- Identify and characterise target machines
- Profiles machines, including:
- Browser, OS, PSP, Patch History
- Activity
- Download
- Automated Target Technology Tracking (Stats \& Trends)
- Browsers, OS, PSP etc
- ORB Identification
- Initial ten fold increase in Orh Identification rate over manual process
# LIE TOP SECRET STR UP 1 

## Defining Attributes

- Attribute Definition
- Name
- Description
- Type
- Data sources

Machine Attributes
DNS Name (webhost.com)
![img-21.jpeg](img-21.jpeg)

FTP login
![img-22.jpeg](img-22.jpeg)

Machine Communication Attributes
![img-23.jpeg](img-23.jpeg)

- Open port $(25,80,443)$
- Server banner (Server: Apache)
- PSP fingerprint (Kaspersky v7.01)
- $\operatorname{XFF}(192.168 .2 .1)$
- Web Request (test.exe, file.pdf)
- SNMP sysname
# UK TOP SECRET STRAP 1 

## MUGSHOT GOALS

- Automated Target Characterisation and Monitoring
- Automatically understand everything important about CNE target networks from passive and active sources.
- Automated Un-Targeted Characterisation
- Automatically understand everything important about all machines on the Internet from passive and active sources.
