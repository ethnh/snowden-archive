# TRANSGRESSION Overview for Pod58 

## S31177

## 7 Feb 2010

DERIVED FROM: NSA/CSSM 1-52
DATED 08 JAN 2007
DECLASSIFY ON: 20320108
TOPSECRET//COMINT//REL TO USA, FVEY
# TRANSGRESSION Charter 

## Original:

Discover, understand, evaluate, and exploit foreign CNE/CNA exploits, implants, command \& control and exfiltration.

## Moving Forward:

Provide cryptanalytic exploitation support for Network Defense (NTOC and IAD), 4th Party. SIGINT (S2, NTOC and TAO), and Cyber (TAO, RATWHARF) missions.
# Organizational Structure 

![img-0.jpeg](img-0.jpeg)

TOPSECRET//COMINT//REL TO USA, FVEY
# Personnel 

- Branch Chief
- Team Lead/TD
- OTP CNE Co-Lead
- MAKERSMARK Lead
- BYZANTINE HADES Lead
- VOYEUR/Iran Lead
- Malware Lead
- Emerging Threats Lead
- MAKERSMARK, RDP Lead

1 CADP, 2 CMP (including DSD Integree), 1 RSE, 2 NIE, 2 STDP
# Major Intrusion Set Efforts 

![img-1.jpeg](img-1.jpeg)

## MAKERSMARK

Enable WALKERBLACK/RED exploitation/improve collection

CROWNROYAL, CROWNPRINCE, SHEPHERD, Zebedee

BYZANTINE HADES
NetDef RDP exploitation
Trojan/beacon deobfuscation
MAVERICK CHURCH PPTP, POPROCKS
VOYEUR (GHOSTRECON
Victim Exfil
SSL Collection
NIGHTTRAIN
Decryption and processing of TAO exfil and passive collect

SRE of malware
SHADOWDRAGON
RDP and password recovery
FAA password recovery

RECORDER
Processing and decryption of passive collect

PLAIDDIANA/INCAADAM
Deobfuscation of passive collect
TWEEZERS
Processing and decryption of passive collect

SNOWGLOBE
Processing and decryption of passive collect

WIDOWKEY/SUPERDRAKE
Future processing and decryption
Numerous other watchlist intrusion sets
Many one off customer requests - cyber cryptanalysis support
# XKEYSCORE: <br> A Critical TRANSGRESSION Tool 

- Over 50 daily workflows
- SIGINT and POLARSTARKEY (NetDef)
- Fingerprints and Microplugins
- GUI Workflows and Webservice
# Our Modernization Efforts 

- XKS Webservice
- xksql and xkproc
- tfsql and tfproc
# A Modernization Example 

- Victim $\rightarrow$
- LP $\rightarrow$
- TAO Op $\rightarrow$
- TUNINGFORK $\rightarrow$
- TRANSGRESSION $\rightarrow$
- SCISSORS $\rightarrow$
- PINWALE and Cloud
# Where does our data come from? 

- XKEYSCORE
- TUNINGFORK
- TAO Direct
- NTOC Internal
- NTOC External
- AFOSI/NCIS
- FBI
- Cyber Command
# What Kinds of Data? (What is the plaintext) 

- Command \& Control

RDP, RAdmin (heavyweight)
many home-grown (lightweight)

- File Transfer

Actor $\rightarrow$ Victim (malware)
Victim $\rightarrow$ Actor (exfil)

- Email
- Credentials
# What Kinds of Encryption? 

1 - "Commercial"

- SSL/TLS
- SSH
- PGP
- PPTP
- RDP / RAdmin
# What Kinds of Encryption? 

## 2 - Other

- Block Ciphers (DES, 3DES)
- Stream Ciphers (RC4)
- Masking
short or long, fixed or variable
- Layered Encryption
# Crypt Examples: Layered Encryption 

- BYZANTINE FOOTHOLD
- SSH
- Mod DES
- WIDOWKEY
- Single Byte XOR

Fixed Key mask
3DES
# Crypt Examples: Setting Key 

- Fixed (ADJUTANT VENTURE)
- From Message Header (RAPTOR ROLEX)
- From Packet Headers (RAPTOR JOY/SAD)
# (U//FOUO) Who to Contact? 

## Email:

## Wiki:

## TOPSECRET//COMINT//REL TO USA, FVEY
# Encodings 

- None (raw binary)
- base64
- Modified base64 (BYZANTINE RAPTOR)
permutation of the 64 base64 characters
HTML Character encoding (ADJUTANT VENTURE)
0x1278cd = '\&\#18;\&\#120;\&\#205'
