![img-0.jpeg](img-0.jpeg)

Small team $=$ faster development

Specialities:
project vision, keeping on track with partner sharing and end-toend automation goals
project vision, MySQL support, analytic perspective
project organization, Whizbang/Cloudbase development, developers perspective
code support for new data flows, MySQL, Whizbang development

Other contributors:
Cloud Support Team
# Field Site Responsibilities 

![img-1.jpeg](img-1.jpeg)

Sniff it all: Maximize receiving capabilities within our viewing arc
Know it all: Survey enough to keep our finger on the pulse of the whole environment
Collect it all: Maximize how many signals we can bring in the door simultaneously
Process it all: Find the data in the signal
Exploit it all: Find the intelligence in the signal
Partner it all: Collaborate on techniques and share data with partners
# For Better Or Worse... 

## Collection access is increasing,

- software modems (ASPHALT/A-PLUS)
- new hardware/software solutions (STORMFORCE modems and DARKQUEST auto-survey)
- new physical capacity (TORUS antennae)


## Processing capabilities are increasing,

- JCE, TINT, XKS Deep Dive

But size of analytic workforce is not!

- more resources = more resource management

We have about 9100 signals in our view
In 2008, we were only processing maybe 100-140 of these
Director's edict to "collect it all"
ASPHALT -> software modems processing low bit rate signals added a 300signal capability
STORMFORCE modems -> combination of hardware and software control increase capacity from 4 signals to 40
TORUS antenna -> 12 receivers (feeds) in place of 1

Now we are at 500, moving quickly towards 1,000
Over the next year, we anticipate collecting 3,000 signals simultaneously

When a resource comes available, which signal do you place on collection???
![img-2.jpeg](img-2.jpeg)

Sniff it all: TORUS adds 12 new feeds to existing 20-some
Know it all: DARKQUEST COMSAT development automates survey to capture all signals, at MHS, in a 2-week span.
Collect it all: Increased modem capacity with software (APLUS) \& STORMFORCE modems.
Process it all: Scale XKS, consider Deep Dive XKS, use MVR techniques such as map/reduce and Cloudbase capabilities
Exploit it all: Query focused datasets - Analysis of data at scale means automate, automate, automate. This is the motivation for ELEGANTCHAOS. Optimize automation to include: automate scoring of links based on current analytical priorities, and feeding prioritized list back to survey tools including DARKQUEST and modems. Secondary goals: transparent process; flexible scoring.
Partner it all: Collaborate on techniques and share data with partners. Cloud solution = TINT; XKS scaling = JCE. First partner: GCHQ/Bude.
# ELEGANTCHAOS Goals 

- Goal: perform basic, time-sensitive analysis on all of MHS collection
- Goal: create a prioritized list of signals (case notations) in our viewing arc
- Goal: use this list to automatically drive collection as collection capabilities increase
- Offshoot goal: create a product that analysts and collection managers can use to see into the system
# ELEGANTCHAOS + Cloud 

The MHS Cloud provides an excellent platform for this project:

- data ingest, normalization, tagging
- access to SIGINT data from various processors, from sustained mission + survey
- access to a huge body of enrichment data
- processing, storage, and web-hosting
- considering decoupling these parts...
![img-3.jpeg](img-3.jpeg)

TARMAC provides target activity, network space,
XKS provides target activity, network space, technologies
POPQUIZ provides malicious discovery across sessions using heuristic-type approaches.

Flexibility in terms of
QFD's: derived from XKS, SLR, Popquiz, etc.
Target activity
Technology
Geo-location
Questions: can combine QFDs
VPNs involving Ivory Coast?
Paired links carrying VOIP or VPN?
Malicious Activity on networks used by targets?

Experiment by doing
Will challenge current tasking methods, hopefully make them easier ;-)
![img-4.jpeg](img-4.jpeg)

This is a simplified view of the ELEGANTCHAOS machinery. Note: a key component that is not shown is the feedback loop into collection.

1) SIGINT and enrichment data enters the system by being copied to the Cloud servers. This may take the form of a MAILORDER flow, a wget grab, or a database file transfer from another system.
2) Data is processed. Some data is processed through the SIGDEV Cloud Stack, which formally validates/normalizes/tags the data. All SIGINT data goes through this process, as well as some of the enrichment data. The remaining enrichment data usually requires some minimal processing or reformatting.
3) The results of step 2, whether pulled from the SIGDEV Cloud Stack via the WhizBang map/reduce API, or copied from an external source, are stored in Question Focused Datasets (QFDs). Some QFDs serve multiple analytic interests, and some analytic interests require an intersection of QFDs to evaluate.
4) ELEGANTCHAOS MySql code pulls analytical questions from a database, queries the QFDs to find case notations satisfying each question, and writes scores to another database. These scoring databases at the heart of EC populate the GUI.
# Data Sources (May 2011) 

## SIGINT Feeds

- XKEYSCORE
- ASDF (Turmoil LIVE)
- SLR (TARMAC)
- POPQUIZ (Turmoil DEV)
- WEALTHYCLUSTER2

Enrichment Feeds

- IPGeoTrap
- TRAVELLINGWAVE Scores
- BILBOBADGER Daily Summaries
- Target Network Service list + CNO Target list
- DRINKYBIRD monitoring info
- GLOBETROTTER OH Geo
- MASTERSHAKE Geo
- Quantumable Case Notation list
# Analytic Questions (May 2011) 

| Target | Technology |
| :--: | :--: |
| - Dictionary hits | - VPNs |
| - Target Networks | - Twitter, Facebook, VoIP |
| - TNS, TW, CNO | - CNO behavior |
| - PLUS Reports, CRNs, etc. | Miscellany |
| Location | - Modem Capacity |
| - IP-based | - Paired Links |
| - MAC-based | - Quantumable |
| - Geo-based |  |
| - Surge Countries |  |
| - Libya, Egypt, Afghanistan, Syria, Yemen, Ivory Coast, etc. |  |

Don't forget combinations (paired links with VPNs, VPNs with target IP networks)
# Questions \& Scoring 

- Each question is represented by a SQL query applied to one or more QFDs
- QFDs are case notation-based repositories of signal information
- eg. IPs and registries for all case notations
- eg. category hits for all case notations
- eg. GLOBETROTTER geos for all case notations
- All questions are asked once per day across all case notations
- Points are assigned to each question based on current analytic priorities
- Points for any particular question are "active" for a window of time (eg, 1 day, 7 days, 30 days)
- The sum of "active" points for a case notation, across all questions, forms the score
# Interfaces 

## Different interfaces for different customers

- ELEGANTCHAOS GUI
- made for analysts to examine scores and the impact of the different questions
- eventually, control over the algorithms may reside here
- REST interface
- made for programmatic query, precursor to auto tasking
- DRINKYBIRD GUI
- made for collection personnel to determine if resources are available, easy to view what's on cover
# EC GUI: Case Notation View 

![img-5.jpeg](img-5.jpeg)

Continual assessment of bearers helps to determine when a bearer becomes less interesting, then it'd be possible to remove it from sustained collection.
![img-6.jpeg](img-6.jpeg)
![img-7.jpeg](img-7.jpeg)

Important to remember, this is our attempt to best utilize increasing capacity. Sits between sustained/CRN collection and continual survey.

Provides ability to turn the dials on "hot topic" of the day.
Can adjust the length of time an event remains interesting and affects prioritization.
Some Questions will always be run. TT hit, confirmed target activity, etc.
Maintains history, so progress can be tracked. Are there more target hits, paired VOIP signals, etc.
![img-8.jpeg](img-8.jpeg)
Focus Areas: Custom Views?
![img-9.jpeg](img-9.jpeg)
![img-10.jpeg](img-10.jpeg)

Interface to ASPHALT is easy with the developers on site !! - CSV file with required case notations FTP'd

Interface kludge into DRINKYBIRD - In-House network and tasking management GUI
![img-11.jpeg](img-11.jpeg)
# Libya Surge 

## PROBLEM

Which of the 1000's of signals surveyed have Libyan / Egyptian / Afghan networks on the VSAT-side?

## SOLUTION

- Pre-run analytics determine "significance"
- Quick identification of 25 'LY' / 11 'EG' / 10 'AF' candidate signals
- Combine other analytics: target hits, pairing, etc.
- (Repeat for next country)
# AMULET STELLAR 

## PROBLEM

Which case notations have traffic on IPs of interest that matches AST fingerprints?

## SOLUTION

- Create IP target set; create whitelist and blacklist of XKS fingerprints
- Use Cloud capabilities to bridge between the set of all SIGINT events with matching fingerprints, and the target set
- Add the scoring question to EC

ADVERTIRED TO USA, AUS, CAN, GER, NZL/2020108

- Correlated IRC Botnet Activity to ASR Intrusion set (IRGC-QF Ramazan Corps Headquarters.)
-Discovered New Victims in Iraq and Iran
$\cdot$Multiple targets associated with S2E tasked selectors
-Discovered New Infrastructure
-Engaged TAO for Vulnerability Assessment Evaluation
-Discovered potential C2, update and exfiltration nodes
-Evaluating $4^{\text {th }}$ Party Collection Opportunities
$\cdot$Tipped: SSG, S2E, NTOC-G, TAO CCNE, documented in CROSSBONES.
-No specific fingerprints highlight this as ASR activity
-Develop new "Infrastructure Agnostic" ASR fingerprints
-Use AES keys for decrypt and potential $4^{\text {th }}$ party collection opportunity
# Ongoing Work 

- New data feeds (FOGHORN, MATCHMAKER, ROADBED)
- More fields from XKS (HTTP language, NetStrings)
- XKS from MOONPENNY
- Fine tuning of GUI for Link Characterization Analysts
- NetStrings study
- Better use of Cloud resources (Link Direction) (CCDP)
- Detailed study of scoring methodology (math hire)
- Close the auto-tasking loop
- Increase awareness and partnership with similar efforts
- Training
![img-12.jpeg](img-12.jpeg)

Is the enterprise considering SLR generation?
